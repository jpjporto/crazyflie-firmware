
#include "stabilizer.h"
#include "stabilizer_types.h"

#include "controller.h"

#include "log.h"
#include "param.h"
#include "math.h"

#include <stdlib.h>
#include <string.h>

static bool isInit = false;

#define HINF_STATES 32
static float xHinf[HINF_STATES * CFNUM];
static float e[12 * CFNUM];

#define DEG_TO_RAD 0.0174533f

void hinfControllerInit(void)
{
  if(isInit)
  {
    return;
  }
  
  memset(xHinf, 0.0f, sizeof(xHinf));
  memset(e, 0.0f, sizeof(e));
  
  isInit= true;
}

void hinfController(control_t *control, setpoint_t *setpoint, const state_t *state, const uint32_t tick)
{
  float u[4];
  float xHinfNext[HINF_STATES * CFNUM];
  
  if(setpoint->poscf1.z > 0.0f) {
    control->enabled = 1;
  } else {
    control->enabled = 0;
  }
  
  if ( fabsf(state->attitude.pitch) > 1.1f || fabsf(state->attitude.roll) > 1.1f) {
    control->enabled = 0;
  } else if (state->position.z >= 2.0f) {
    control->enabled = 0;
  }
  
  
  if (RATE_DO_EXECUTE(HINF_RATE, tick) && (control->enabled)) 
  {
#if CFNUM==1
    e[0] = (setpoint->poscf1.x - state->position.x);
    e[1] = (setpoint->poscf1.y - state->position.y);
    e[2] = (setpoint->poscf1.z - state->position.z);
    e[3] = (setpoint->velcf1.x - state->velocity.x);
    e[4] = (setpoint->velcf1.y - state->velocity.y);
    e[5] = (setpoint->velcf1.z - state->velocity.z);
    e[6] = (0.0f - state->attitude.roll);
    e[7] = (0.0f - state->attitude.pitch);
    e[8] = (setpoint->attitude.yaw - state->attitude.yaw); 
    e[9] = (0.0f - state->attitudeRate.roll);
    e[10] = (0.0f - state->attitudeRate.pitch);
    e[11] = (0.0f - state->attitudeRate.yaw);
#elif CFNUM==2
    e[0] = (setpoint->poscf1.x - state->poscf1.x);
    e[1] = (setpoint->poscf1.y - state->poscf1.y);
    e[2] = (setpoint->poscf1.z - state->poscf1.z);
    e[3] = (setpoint->velcf1.x - state->velcf1.x);
    e[4] = (setpoint->velcf1.y - state->velcf1.y);
    e[5] = (setpoint->velcf1.z - state->velcf1.z);
    e[6] = 0.0f;
    e[7] = 0.0f;
    e[8] = 0.0f; 
    e[9] = 0.0f;
    e[10] = 0.0f;
    e[11] = 0.0f;
    e[12] = (setpoint->poscf2.x - state->position.x);
    e[13] = (setpoint->poscf2.y - state->position.y);
    e[14] = (setpoint->poscf2.z - state->position.z);
    e[15] = (setpoint->velcf2.x - state->velocity.x);
    e[16] = (setpoint->velcf2.y - state->velocity.y);
    e[17] = (setpoint->velcf2.z - state->velocity.z);
    e[18] = (0.0f - state->attitude.roll);
    e[19] = (0.0f - state->attitude.pitch);
    e[20] = (setpoint->attitude.yaw - state->attitude.yaw); 
    e[21] = (0.0f - state->attitudeRate.roll);
    e[22] = (0.0f - state->attitudeRate.pitch);
    e[23] = (0.0f - state->attitudeRate.yaw);
#elif CFNUM==3
#endif

#if CFNUM==1
    u[0] = +2.7869838e-01f*xHinf[2]-2.0742624e-03f*xHinf[5]-5.2766304e-02f*xHinf[14]+1.7820410e-02f*xHinf[18]+6.1139306e-03f*xHinf[21]-1.5321823e-03f*xHinf[30]+2.9760948e-01f*e[2]+3.3474174e-01f*e[5];
    u[1] = -1.0698261e-02f*xHinf[1]+1.0709916e-04f*xHinf[4]-2.1051109e-04f*xHinf[6]+1.5775286e-04f*xHinf[9]+2.4106991e-03f*xHinf[13]-3.6468907e-04f*xHinf[17]+4.3307977e-05f*xHinf[20]-6.1204293e-05f*xHinf[22]-6.4748223e-05f*xHinf[25]+1.3583073e-04f*xHinf[29]-8.9221243e-03f*e[1]-1.7120633e-02f*e[4]+3.4938328e-02f*e[6]+9.6718529e-03f*e[9];
    u[2] = +1.0712611e-02f*xHinf[0]-1.0777144e-04f*xHinf[3]-2.1038603e-04f*xHinf[7]+1.5771184e-04f*xHinf[10]-2.4116852e-03f*xHinf[12]+3.6516410e-04f*xHinf[16]-4.3566175e-05f*xHinf[19]-6.1438150e-05f*xHinf[23]-6.5023625e-05f*xHinf[26]-1.3588154e-04f*xHinf[28]+8.9367777e-03f*e[0]+1.7187880e-02f*e[3]+3.4935806e-02f*e[7]+9.6655339e-03f*e[10];
    u[3] = +1.2088305e-02f*xHinf[8]+5.2885634e-06f*xHinf[11]-5.5657267e-03f*xHinf[15]+4.5346509e-04f*xHinf[24]+1.4805352e-05f*xHinf[27]-2.6240069e-04f*xHinf[31]+1.1545208e-02f*e[8]+1.3633251e-02f*e[11];


    xHinfNext[0] = +5.2162004e-01f*xHinf[0]+2.1411385e-03f*xHinf[3]+3.8880385e-03f*xHinf[7]-7.6799240e-04f*xHinf[10]+4.3928724e-02f*xHinf[12]-1.6363289e-02f*xHinf[16]+3.9188965e-08f*xHinf[18]+7.1972380e-03f*xHinf[19]+6.7724609e-03f*xHinf[23]+1.2699543e-02f*xHinf[26]+6.8044402e-03f*xHinf[28]+4.2176634e-01f*e[0]-2.2572191e-01f*e[3]-3.9393052e-01f*e[7]-9.2830859e-02f*e[10];
    xHinfNext[1] = +5.2209258e-01f*xHinf[1]+2.1245121e-03f*xHinf[4]-3.8841579e-03f*xHinf[6]+7.6618587e-04f*xHinf[9]+4.3845620e-02f*xHinf[13]-1.6364990e-02f*xHinf[17]+7.1885982e-03f*xHinf[20]-6.7728679e-03f*xHinf[22]-1.2701433e-02f*xHinf[25]+6.7889951e-03f*xHinf[29]+4.2202294e-01f*e[1]-2.2277600e-01f*e[4]+3.9337957e-01f*e[6]+9.2742793e-02f*e[9];
    xHinfNext[2] = +4.9017072e-01f*xHinf[2]+2.4748826e-03f*xHinf[5]+4.1126277e-02f*xHinf[14]-3.7786283e-02f*xHinf[18]-5.2071381e-03f*xHinf[21]+3.5368588e-02f*xHinf[30]+4.8938507e-01f*e[2]-1.4059381e-01f*e[5];
    xHinfNext[3] = +5.4350853e-02f*xHinf[0]-2.9087514e-03f*xHinf[3]+1.8838313e-03f*xHinf[7]+3.2369487e-04f*xHinf[10]+2.3731655e-02f*xHinf[12]-3.2494572e-05f*xHinf[16]-1.3786396e-08f*xHinf[18]+6.7821459e-04f*xHinf[19]+6.2070321e-04f*xHinf[23]-3.1694413e-05f*xHinf[26]-1.0929317e-03f*xHinf[28]+4.2100798e-02f*e[0]+1.6906190e+00f*e[3]-3.1315383e-02f*e[7]-8.9033972e-03f*e[10];
    xHinfNext[4] = +5.4188319e-02f*xHinf[1]-2.9225315e-03f*xHinf[4]-1.8707387e-03f*xHinf[6]-3.2208386e-04f*xHinf[9]+2.3548534e-02f*xHinf[13]+6.4707228e-06f*xHinf[17]+6.5904652e-04f*xHinf[20]-6.0903281e-04f*xHinf[22]+4.5037665e-05f*xHinf[25]-1.1101710e-03f*xHinf[29]+4.1980486e-02f*e[1]+1.6908948e+00f*e[4]+3.0774802e-02f*e[6]+8.8633858e-03f*e[9];
    xHinfNext[5] = -2.6081178e-02f*xHinf[2]-1.3032674e-03f*xHinf[5]+5.0776675e-02f*xHinf[14]-1.4228405e-02f*xHinf[18]-2.0846610e-03f*xHinf[21]-1.1560959e-02f*xHinf[30]-3.7633300e-02f*e[2]+1.5426028e+00f*e[5];
    xHinfNext[6] = -1.3317043e-01f*xHinf[1]-1.7676044e-03f*xHinf[4]-3.8261889e-04f*xHinf[6]+6.2883284e-04f*xHinf[9]-3.2442532e-02f*xHinf[13]-8.0894300e-04f*xHinf[17]-1.1477018e-03f*xHinf[20]+1.3891263e-03f*xHinf[22]-3.6066395e-04f*xHinf[25]+3.3081146e-03f*xHinf[29]-1.0494271e-01f*e[1]-2.0526955e-01f*e[4]+1.6336126e+00f*e[6]-2.0607790e-02f*e[9];
    xHinfNext[7] = +1.3307458e-01f*xHinf[0]+1.7756041e-03f*xHinf[3]-3.8498553e-04f*xHinf[7]+6.2654470e-04f*xHinf[10]+3.2445271e-02f*xHinf[12]+8.3988521e-04f*xHinf[16]-3.6283534e-08f*xHinf[18]+1.1387542e-03f*xHinf[19]+1.3793063e-03f*xHinf[23]-3.7869412e-04f*xHinf[26]-3.3072792e-03f*xHinf[28]+1.0489909e-01f*e[0]+2.0564988e-01f*e[3]+1.6331823e+00f*e[7]-2.0636389e-02f*e[10];
    xHinfNext[8] = +5.5756772e-01f*xHinf[8]+8.8841456e-04f*xHinf[11]+4.0795889e-02f*xHinf[15]-9.8859863e-03f*xHinf[24]+2.1515312e-02f*xHinf[27]+9.9430215e-03f*xHinf[31]+4.8912641e-01f*e[8]-8.6307779e-02f*e[11];
    xHinfNext[9] = +1.5040252e+00f*xHinf[1]-1.4555702e-02f*xHinf[4]+2.7994489e-02f*xHinf[6]+5.5224379e-03f*xHinf[9]-3.5112658e-01f*xHinf[13]+5.2282795e-02f*xHinf[17]-6.5144617e-03f*xHinf[20]+9.1401283e-03f*xHinf[22]+9.3385428e-03f*xHinf[25]-1.9046871e-02f*xHinf[29]+1.2546715e+00f*e[1]+2.4061301e+00f*e[4]-4.9099908e+00f*e[6]+2.7509481e-01f*e[9];
    xHinfNext[10] = -1.5060936e+00f*xHinf[0]-1.3512970e-08f*xHinf[2]+1.4651112e-02f*xHinf[3]+2.7980534e-02f*xHinf[7]+5.5287885e-03f*xHinf[10]+3.5125315e-01f*xHinf[12]-5.2342586e-02f*xHinf[16]+5.7403188e-08f*xHinf[18]+6.5491199e-03f*xHinf[19]-3.8416132e-08f*xHinf[21]+9.1712438e-03f*xHinf[23]+9.3737980e-03f*xHinf[26]+1.9053902e-02f*xHinf[28]-5.4326847e-08f*xHinf[30]-1.2567744e+00f*e[0]-2.4156678e+00f*e[3]-1.3463220e-08f*e[5]-4.9098072e+00f*e[7]+2.7599347e-01f*e[10];
    xHinfNext[11] = -1.2426677e+00f*xHinf[8]+2.8202940e-02f*xHinf[11]+6.1418873e-01f*xHinf[15]-4.9510535e-02f*xHinf[24]+5.8889872e-04f*xHinf[27]+2.9924715e-02f*xHinf[31]-1.1899914e+00f*e[8]+2.1354210e-01f*e[11];
    xHinfNext[12] = +5.4504111e-02f*xHinf[0]+3.5388976e-02f*xHinf[3]+6.1352614e-02f*xHinf[7]+1.2577944e-02f*xHinf[10]+9.8648691e-01f*xHinf[12]+2.1228141e-03f*xHinf[16]-7.4577500e-04f*xHinf[19]-7.7645847e-04f*xHinf[23]-1.0624900e-03f*xHinf[26]-6.1132835e-04f*xHinf[28]-3.5082567e-02f*e[0]-5.0531607e-03f*e[3]+3.3273909e-02f*e[7]+1.7415605e-02f*e[10];
    xHinfNext[13] = +5.4448951e-02f*xHinf[1]+3.5184391e-02f*xHinf[4]-6.1398316e-02f*xHinf[6]-1.2601897e-02f*xHinf[9]+9.8649836e-01f*xHinf[13]+2.1225947e-03f*xHinf[17]-7.4405398e-04f*xHinf[20]+7.7586545e-04f*xHinf[22]+1.0621545e-03f*xHinf[25]-6.0981238e-04f*xHinf[29]-3.5087492e-02f*e[1]-5.0496389e-03f*e[4]-3.3225071e-02f*e[6]-1.7416537e-02f*e[9];
    xHinfNext[14] = +4.2022392e-02f*xHinf[2]+4.5359906e-02f*xHinf[5]+9.9414253e-01f*xHinf[14]+3.6612193e-03f*xHinf[18]+5.1714166e-04f*xHinf[21]-2.1999001e-03f*xHinf[30]-1.4585246e-01f*e[2]-5.8227953e-02f*e[5];
    xHinfNext[15] = +1.0526785e-01f*xHinf[8]+4.1843444e-02f*xHinf[11]+9.6346074e-01f*xHinf[15]+3.3594244e-03f*xHinf[24]-2.0470954e-03f*xHinf[27]-2.4005652e-03f*xHinf[31]-3.4195803e-02f*e[8]+1.3312709e-02f*e[11];
    xHinfNext[16] = -1.9534975e-02f*xHinf[0]-1.7981959e-03f*xHinf[3]-3.5660730e-03f*xHinf[7]-1.0388057e-03f*xHinf[10]+2.2146692e-03f*xHinf[12]+7.2601753e-01f*xHinf[16]-2.1328396e-01f*xHinf[19]-1.6453829e-01f*xHinf[23]-3.1069896e-01f*xHinf[26]+5.4111976e-02f*xHinf[28]+1.8555993e-02f*e[0]-6.4434372e-03f*e[3]-1.2204261e-02f*e[7]-3.1248510e-03f*e[10];
    xHinfNext[17] = -1.9540897e-02f*xHinf[1]-1.7544951e-03f*xHinf[4]+3.6001396e-03f*xHinf[6]+1.0474642e-03f*xHinf[9]+2.2142574e-03f*xHinf[13]+7.2638094e-01f*xHinf[17]-2.1310264e-01f*xHinf[20]+1.6459614e-01f*xHinf[22]+3.1073797e-01f*xHinf[25]+5.3745754e-02f*xHinf[29]+1.8588070e-02f*e[1]-6.4073177e-03f*e[4]+1.2163449e-02f*e[6]+3.1183870e-03f*e[9];
    xHinfNext[18] = +4.1262076e-08f*xHinf[0]-3.8052958e-02f*xHinf[2]-1.1648232e-08f*xHinf[3]-1.2462168e-02f*xHinf[5]-3.1066829e-08f*xHinf[7]+3.7498039e-03f*xHinf[14]+9.7915798e-01f*xHinf[18]+1.0510650e-02f*xHinf[21]-4.0481561e-03f*xHinf[30]-4.0344066e-08f*e[0]+3.6807314e-02f*e[2]+3.5890963e-08f*e[3]+8.7568285e-03f*e[5]+6.3365569e-08f*e[7]+1.0952413e-08f*e[10];
    xHinfNext[19] = +6.9822287e-03f*xHinf[0]+9.2999439e-04f*xHinf[3]+1.7280673e-03f*xHinf[7]+4.5719006e-04f*xHinf[10]-7.4327318e-04f*xHinf[12]-2.4103636e-01f*xHinf[16]+7.9408228e-01f*xHinf[19]-1.4001332e-01f*xHinf[23]-2.7884901e-01f*xHinf[26]+5.1395968e-02f*xHinf[28]-4.5638857e-03f*e[0]+2.0180803e-03f*e[3]+4.2436263e-03f*e[7]+7.6950755e-04f*e[10];
    xHinfNext[20] = +6.9684437e-03f*xHinf[1]+9.0727769e-04f*xHinf[4]-1.7360079e-03f*xHinf[6]-4.5920277e-04f*xHinf[9]-7.4144162e-04f*xHinf[13]-2.4076496e-01f*xHinf[17]+7.9420090e-01f*xHinf[20]+1.4009802e-01f*xHinf[22]+2.7894366e-01f*xHinf[25]+5.1066421e-02f*xHinf[29]-4.5543197e-03f*e[1]+2.0106288e-03f*e[4]-4.2210296e-03f*e[6]-7.6409336e-04f*e[9];
    xHinfNext[21] = -4.4059618e-03f*xHinf[2]-1.4041499e-03f*xHinf[5]+4.9389288e-04f*xHinf[14]-1.2345792e-03f*xHinf[18]+9.7568792e-01f*xHinf[21]+2.8497826e-02f*xHinf[30]+3.8969896e-03f*e[2]+6.4739428e-04f*e[5];
    xHinfNext[22] = -5.6704078e-03f*xHinf[1]-8.7676971e-04f*xHinf[4]+2.0602995e-03f*xHinf[6]+5.3881481e-04f*xHinf[9]+6.9248694e-04f*xHinf[13]+1.5367781e-01f*xHinf[17]+1.2046108e-01f*xHinf[20]+9.0116620e-01f*xHinf[22]-1.6839264e-01f*xHinf[25]-2.7956277e-02f*xHinf[29]+3.5698535e-03f*e[1]-1.6532165e-03f*e[4]+3.2051965e-03f*e[6]+6.5398013e-04f*e[9];
    xHinfNext[23] = +5.6750621e-03f*xHinf[0]+8.8923913e-04f*xHinf[3]+2.0521008e-03f*xHinf[7]+5.3685851e-04f*xHinf[10]-6.9326418e-04f*xHinf[12]-1.5369779e-01f*xHinf[16]-1.2042343e-01f*xHinf[19]+9.0131068e-01f*xHinf[23]-1.6815731e-01f*xHinf[26]+2.8128460e-02f*xHinf[28]-3.5694696e-03f*e[0]+1.6673779e-03f*e[3]+3.2213067e-03f*e[7]+6.5751810e-04f*e[10];
    xHinfNext[24] = -1.8335460e-02f*xHinf[8]-2.7119471e-03f*xHinf[11]+3.5028593e-03f*xHinf[15]+6.8300629e-01f*xHinf[24]-4.1486692e-01f*xHinf[27]+7.9191931e-02f*xHinf[31]+1.7724920e-02f*e[8]-2.5923324e-03f*e[11];
    xHinfNext[25] = -1.2834168e-02f*xHinf[1]-3.4858374e-04f*xHinf[4]+5.3136703e-04f*xHinf[6]+2.8367943e-04f*xHinf[9]+1.1027347e-03f*xHinf[13]+3.7188599e-01f*xHinf[17]+3.0186263e-01f*xHinf[20]-2.3237380e-01f*xHinf[22]+5.6360936e-01f*xHinf[25]-7.1984321e-02f*xHinf[29]+9.6078003e-03f*e[1]-5.2975616e-03f*e[4]+9.5552644e-03f*e[6]+1.6339935e-03f*e[9];
    xHinfNext[26] = +1.2842476e-02f*xHinf[0]+3.6834218e-04f*xHinf[3]+5.1311671e-04f*xHinf[7]+2.7955705e-04f*xHinf[10]-1.1034434e-03f*xHinf[12]-3.7203890e-01f*xHinf[16]-3.0186087e-01f*xHinf[19]-2.3209040e-01f*xHinf[23]+5.6405389e-01f*xHinf[26]+7.2428904e-02f*xHinf[28]-9.6122762e-03f*e[0]+5.3368974e-03f*e[3]+9.5809791e-03f*e[7]+1.6399664e-03f*e[10];
    xHinfNext[27] = +2.0495031e-02f*xHinf[8]+2.5955001e-03f*xHinf[11]-2.1682240e-03f*xHinf[15]-4.9387828e-01f*xHinf[24]+3.2014203e-01f*xHinf[27]+1.2582877e-01f*xHinf[31]-1.1348271e-02f*e[8]+1.3543252e-03f*e[11];
    xHinfNext[28] = +8.3341720e-03f*xHinf[0]-4.0223057e-04f*xHinf[3]-1.6111340e-03f*xHinf[7]-1.9781422e-05f*xHinf[10]-6.6948211e-04f*xHinf[12]+3.7203260e-02f*xHinf[16]+3.8988348e-02f*xHinf[19]+2.4485257e-02f*xHinf[23]+4.5719322e-02f*xHinf[26]+9.8613131e-01f*xHinf[28]-7.4563609e-03f*e[0]+4.6438584e-03f*e[3]+8.7761832e-03f*e[7]+1.5238820e-03f*e[10];
    xHinfNext[29] = +8.3170896e-03f*xHinf[1]-4.2190554e-04f*xHinf[4]+1.6087738e-03f*xHinf[6]+1.8837647e-05f*xHinf[9]-6.6767464e-04f*xHinf[13]+3.6899820e-02f*xHinf[17]+3.8760278e-02f*xHinf[20]-2.4351586e-02f*xHinf[22]-4.5437824e-02f*xHinf[25]+9.8624879e-01f*xHinf[29]-7.4380911e-03f*e[1]+4.6298094e-03f*e[4]-8.7734582e-03f*e[6]-1.5237398e-03f*e[9];
    xHinfNext[30] = +3.5755783e-02f*xHinf[2]-1.1674435e-02f*xHinf[5]-2.3250130e-03f*xHinf[14]-8.8701444e-03f*xHinf[18]+1.9670554e-02f*xHinf[21]+9.6495551e-01f*xHinf[30]-1.8706221e-08f*e[0]-3.4319829e-02f*e[2]+2.8129477e-02f*e[5];
    xHinfNext[31] = +1.5260125e-02f*xHinf[8]+3.0410991e-03f*xHinf[11]-2.5561645e-03f*xHinf[15]+4.8014306e-02f*xHinf[24]+8.2619138e-02f*xHinf[27]+9.7314495e-01f*xHinf[31]-1.2307071e-02f*e[8]+4.7280392e-04f*e[11];

#elif CFNUM==2
    u[0] = +1.2267385e-01f*xHinf[2]-7.3011178e-03f*xHinf[5]-1.5470024e-02f*xHinf[14]-8.0657715e-01f*xHinf[18]-2.4587345e+00f*xHinf[21]-1.7243022e+00f*xHinf[30]+3.3692354e-01f*xHinf[34]-2.8053159e-03f*xHinf[37]-2.4504727e-03f*xHinf[46]+2.4594479e+00f*xHinf[50]+6.2099744e-02f*xHinf[53]-5.1201310e+00f*xHinf[62]+1.9468801e-01f*e[2]+2.5462422e+00f*e[5]+1.1243620e+00f*e[14]+2.5211585e+00f*e[17]-1.1322805e-05f*e[19];
    u[1] = -3.3475170e-04f*xHinf[1]-1.1926105e-05f*xHinf[6]+1.5905729e-05f*xHinf[13]-1.8777543e-03f*xHinf[17]-8.2021597e-04f*xHinf[20]+1.0977921e-03f*xHinf[22]+8.5046631e-04f*xHinf[25]+8.2507869e-03f*xHinf[29]-7.2276872e-04f*xHinf[33]+1.3209092e-05f*xHinf[36]-3.6527537e-05f*xHinf[38]-7.0062601e-03f*xHinf[49]-1.3195342e-04f*xHinf[52]-2.7474347e-03f*xHinf[54]+2.6593756e-04f*xHinf[57]+1.0687049e-02f*xHinf[61]-3.8777484e-04f*e[1]-1.2401544e-02f*e[4]-2.5939108e-03f*e[13]-1.2348533e-02f*e[16]+3.9136890e-02f*e[18]+8.6089009e-03f*e[21];
    u[2] = +3.4097204e-04f*xHinf[0]-1.1772715e-05f*xHinf[7]-1.6115355e-05f*xHinf[12]+1.8694701e-03f*xHinf[16]+7.9643156e-04f*xHinf[19]+1.0775417e-03f*xHinf[23]+8.1838237e-04f*xHinf[26]-8.2528954e-03f*xHinf[28]+7.1369548e-04f*xHinf[32]-1.7860179e-05f*xHinf[35]-3.6279467e-05f*xHinf[39]+7.0300875e-03f*xHinf[48]+1.1614535e-04f*xHinf[51]-2.5609862e-03f*xHinf[55]+2.6286696e-04f*xHinf[58]-1.0609466e-02f*xHinf[60]+3.9390332e-04f*e[0]+1.2473883e-02f*e[3]+2.6012575e-03f*e[12]+1.2432504e-02f*e[15]+3.8807165e-02f*e[19]+8.6689303e-03f*e[22];
    u[3] = +6.5842603e-04f*xHinf[8]-1.6994651e-05f*xHinf[11]+1.9909316e-05f*xHinf[15]+6.3224444e-03f*xHinf[24]+6.5911757e-03f*xHinf[27]-2.5255999e-03f*xHinf[31]+1.3081337e-03f*xHinf[40]-1.9852252e-05f*xHinf[47]+9.7589614e-03f*xHinf[56]-6.8481918e-04f*xHinf[59]-1.5595629e-02f*xHinf[63]+5.1471358e-03f*e[20]+1.3122790e-02f*e[23];


    xHinfNext[0] = +7.6078534e-01f*xHinf[0]+1.3082163e-04f*xHinf[3]-3.5842360e-04f*xHinf[7]-1.0968976e-03f*xHinf[10]+1.5962385e-02f*xHinf[12]-3.2387425e-03f*xHinf[16]+4.0328396e-03f*xHinf[19]+2.6430271e-03f*xHinf[23]+7.3187551e-03f*xHinf[26]+1.7495647e-03f*xHinf[28]+3.9458144e-01f*e[0]-7.9654083e-02f*e[3];
    xHinfNext[1] = +7.6108944e-01f*xHinf[1]+2.3628151e-04f*xHinf[4]+4.0416507e-04f*xHinf[6]+1.1005286e-03f*xHinf[9]+1.5807349e-02f*xHinf[13]-3.3577411e-03f*xHinf[17]+4.1282298e-03f*xHinf[20]-2.5912225e-03f*xHinf[22]-7.1291653e-03f*xHinf[25]+1.7857284e-03f*xHinf[29]+3.9385405e-01f*e[1]-1.0327898e-01f*e[4];
    xHinfNext[2] = +7.6945931e-01f*xHinf[2]+1.1056071e-03f*xHinf[5]+1.9705370e-02f*xHinf[14]-7.6637883e-03f*xHinf[18]+6.2555722e-03f*xHinf[21]+2.3916548e-02f*xHinf[30]+4.0886292e-01f*e[2]-4.2645801e-02f*e[5];
    xHinfNext[3] = +5.1742461e-02f*xHinf[0]+1.6498448e-02f*xHinf[3]+8.1352849e-04f*xHinf[7]-2.4384503e-04f*xHinf[10]+1.4601362e-02f*xHinf[12]-1.2641086e-04f*xHinf[16]-1.7444238e-04f*xHinf[19]+3.6098016e-05f*xHinf[23]+1.0871309e-04f*xHinf[26]-1.5976090e-03f*xHinf[28]+2.6236212e-02f*e[0]+2.2287691e+00f*e[3];
    xHinfNext[4] = +5.4122325e-02f*xHinf[1]+1.6526682e-02f*xHinf[4]-7.7603734e-04f*xHinf[6]+2.6339354e-04f*xHinf[9]+1.6028857e-02f*xHinf[13]-5.4158678e-04f*xHinf[17]-1.1367410e-04f*xHinf[20]-5.8477533e-05f*xHinf[22]-2.9315427e-04f*xHinf[25]-1.7103562e-03f*xHinf[29]+2.7560893e-02f*e[1]+2.2278402e+00f*e[4];
    xHinfNext[5] = -6.0656148e-01f*xHinf[2]+2.5640287e-02f*xHinf[5]+1.7897445e-01f*xHinf[14]-2.4579713e-02f*xHinf[18]+1.3362024e-02f*xHinf[21]+1.7407229e-02f*xHinf[30]-3.6252365e-01f*e[2]+1.6619631e+00f*e[5];
    xHinfNext[6] = -1.5798946e-01f*xHinf[1]+2.3852695e-05f*xHinf[4]+1.8938482e-02f*xHinf[6]-9.3367056e-04f*xHinf[9]-3.8441613e-02f*xHinf[13]+1.9233729e-03f*xHinf[17]-1.4937055e-04f*xHinf[20]+6.5222301e-04f*xHinf[22]+1.4946329e-03f*xHinf[25]+2.7797606e-03f*xHinf[29]-8.2854047e-02f*e[1]-2.7110738e-01f*e[4];
    xHinfNext[7] = +1.5902580e-01f*xHinf[0]-2.5275820e-05f*xHinf[3]+1.8968482e-02f*xHinf[7]-9.2830119e-04f*xHinf[10]+3.8543701e-02f*xHinf[12]-1.8336925e-03f*xHinf[16]+1.4008374e-04f*xHinf[19]+6.5433740e-04f*xHinf[23]+1.4878009e-03f*xHinf[26]-2.8265584e-03f*xHinf[28]+8.3583333e-02f*e[0]+2.5727269e-01f*e[3];
    xHinfNext[8] = +7.5308305e-01f*xHinf[8]-8.3986856e-04f*xHinf[11]+1.3010845e-02f*xHinf[15]+4.1305932e-05f*xHinf[24]+1.6577577e-02f*xHinf[27]+1.4882696e-05f*xHinf[28]+5.1550535e-03f*xHinf[31];
    xHinfNext[9] = +2.0745380e+00f*xHinf[1]+4.8111402e-03f*xHinf[4]-3.0001830e-02f*xHinf[6]+1.7250756e-02f*xHinf[9]-4.0114781e-01f*xHinf[13]+5.1726039e-02f*xHinf[17]-5.9916531e-03f*xHinf[20]+5.8703981e-03f*xHinf[22]+1.0831542e-02f*xHinf[25]-1.2966661e-02f*xHinf[29]+1.1152583e+00f*e[1]+3.5457804e+00f*e[4];
    xHinfNext[10] = -2.0802624e+00f*xHinf[0]-4.2617386e-03f*xHinf[3]-2.9877666e-02f*xHinf[7]+1.7238697e-02f*xHinf[10]+4.0383860e-01f*xHinf[12]-5.2071992e-02f*xHinf[16]+4.6285940e-03f*xHinf[19]+5.8979527e-03f*xHinf[23]+3.7483911e-05f*xHinf[24]+1.1210447e-02f*xHinf[26]+1.2831560e-02f*xHinf[28]-1.1208570e+00f*e[0]-3.3525307e+00f*e[3];
    xHinfNext[11] = -2.0248933e+00f*xHinf[8]+1.9458903e-02f*xHinf[11]-1.6594066e-05f*xHinf[12]+6.3359052e-01f*xHinf[15]-3.6821541e-05f*xHinf[16]+1.1413545e-05f*xHinf[23]-6.8848483e-02f*xHinf[24]+1.3196731e-05f*xHinf[26]+5.7774629e-03f*xHinf[27]+1.9725539e-05f*xHinf[28]+4.5718074e-02f*xHinf[31];
    xHinfNext[12] = +3.1189287e-02f*xHinf[0]+2.4339341e-02f*xHinf[3]+6.8707637e-02f*xHinf[7]+1.3169385e-02f*xHinf[10]+9.9008787e-01f*xHinf[12]+1.0734580e-03f*xHinf[16]-2.8502566e-04f*xHinf[19]-2.7189087e-04f*xHinf[23]-6.5446441e-04f*xHinf[26]-4.3116001e-05f*xHinf[28]-4.6307597e-02f*e[0]-1.8635323e-02f*e[3];
    xHinfNext[13] = +3.0694101e-02f*xHinf[1]+2.6179966e-02f*xHinf[4]-6.8294227e-02f*xHinf[6]-1.3090967e-02f*xHinf[9]+9.9014032e-01f*xHinf[13]+1.0823085e-03f*xHinf[17]-3.0988079e-04f*xHinf[20]+2.6722840e-04f*xHinf[22]+6.3947600e-04f*xHinf[25]-4.1097002e-05f*xHinf[29]-4.6102561e-02f*e[1]-1.9885678e-02f*e[4];
    xHinfNext[14] = +3.2055072e-02f*xHinf[2]+2.2503162e-02f*xHinf[5]+9.9424952e-01f*xHinf[14]+1.1659062e-03f*xHinf[18]-8.0479280e-04f*xHinf[21]-2.2583287e-03f*xHinf[30]-1.6987319e-01f*e[2]-3.5320710e-02f*e[5];
    xHinfNext[15] = +4.9939483e-02f*xHinf[8]+1.7962050e-02f*xHinf[11]+9.8721129e-01f*xHinf[15]+1.3480777e-03f*xHinf[24]-8.2210876e-04f*xHinf[27]-1.1172097e-03f*xHinf[31];
    xHinfNext[16] = -6.7052213e-03f*xHinf[0]-1.4934166e-03f*xHinf[3]-5.8036451e-03f*xHinf[7]-1.3577390e-03f*xHinf[10]+1.2072930e-03f*xHinf[12]+7.9548812e-01f*xHinf[16]-1.7957596e-01f*xHinf[19]-1.0415713e-01f*xHinf[23]-2.8373176e-01f*xHinf[26]+1.9155888e-01f*xHinf[28]+7.7547627e-03f*e[0]-1.1229418e-03f*e[3];
    xHinfNext[17] = -6.7265416e-03f*xHinf[1]-1.9548158e-03f*xHinf[4]+5.8474322e-03f*xHinf[6]+1.3680864e-03f*xHinf[9]+1.2152136e-03f*xHinf[13]+7.9609448e-01f*xHinf[17]-1.7932294e-01f*xHinf[20]+1.0414648e-01f*xHinf[22]+2.8351274e-01f*xHinf[25]+1.9138826e-01f*xHinf[29]+7.8584785e-03f*e[1]-7.5834064e-04f*e[4];
    xHinfNext[18] = -8.6493567e-03f*xHinf[2]-1.7993052e-03f*xHinf[5]+1.2189326e-03f*xHinf[14]+9.5188785e-01f*xHinf[18]-6.1901685e-02f*xHinf[21]+7.9110473e-02f*xHinf[30]+1.2188823e-02f*e[2]+1.3292724e-03f*e[5];
    xHinfNext[19] = +3.1879144e-03f*xHinf[0]-1.0888291e-04f*xHinf[3]+5.9831660e-04f*xHinf[7]+2.6707101e-04f*xHinf[10]-1.9659293e-04f*xHinf[12]-1.9642612e-01f*xHinf[16]+8.0583805e-01f*xHinf[19]-9.4789803e-02f*xHinf[23]-2.8358722e-01f*xHinf[26]+1.9855478e-01f*xHinf[28]-4.2595686e-03f*e[0]+1.8523462e-03f*e[3];
    xHinfNext[20] = +3.3707684e-03f*xHinf[1]-7.1086799e-04f*xHinf[6]-2.8931178e-04f*xHinf[9]-2.2126004e-04f*xHinf[13]-1.9599694e-01f*xHinf[17]+8.0592108e-01f*xHinf[20]+9.4879776e-02f*xHinf[22]+2.8362957e-01f*xHinf[25]+1.9851188e-01f*xHinf[29]-4.5071994e-03f*e[1]+2.0344362e-03f*e[4];
    xHinfNext[21] = +9.7573036e-03f*xHinf[2]+2.0325468e-03f*xHinf[5]-8.3239423e-04f*xHinf[14]-8.5472018e-02f*xHinf[18]+8.0830646e-01f*xHinf[21]+2.1540430e-01f*xHinf[30]-1.3982096e-02f*e[2]-1.6806807e-03f*e[5];
    xHinfNext[22] = -2.1052775e-03f*xHinf[1]-1.6145386e-04f*xHinf[4]+1.0655288e-03f*xHinf[6]+3.2437869e-04f*xHinf[9]+2.0764154e-04f*xHinf[13]+1.0412940e-01f*xHinf[17]+9.3517505e-02f*xHinf[20]+9.3998969e-01f*xHinf[22]-1.3853246e-01f*xHinf[25]-9.8666631e-02f*xHinf[29]+2.6779196e-03f*e[1]-1.0119983e-03f*e[4];
    xHinfNext[23] = +2.1442990e-03f*xHinf[0]+1.3176928e-04f*xHinf[3]+1.0708297e-03f*xHinf[7]+3.2712973e-04f*xHinf[10]-2.1253859e-04f*xHinf[12]-1.0429433e-01f*xHinf[16]-9.3504816e-02f*xHinf[19]+9.4005692e-01f*xHinf[23]-1.3843274e-01f*xHinf[26]+9.8599158e-02f*xHinf[28]-2.7131962e-03f*e[0]+8.9684932e-04f*e[3];
    xHinfNext[24] = -9.0958113e-03f*xHinf[8]-1.5150952e-03f*xHinf[11]+1.3094089e-03f*xHinf[15]+6.6225481e-01f*xHinf[24]-4.4501778e-01f*xHinf[27]+1.1973497e-05f*xHinf[28]+5.5216994e-02f*xHinf[31];
    xHinfNext[25] = -5.9368880e-03f*xHinf[1]-4.9025676e-04f*xHinf[4]+2.4239526e-03f*xHinf[6]+5.5158581e-04f*xHinf[9]+4.9777690e-04f*xHinf[13]+3.0675942e-01f*xHinf[17]+2.9085529e-01f*xHinf[20]-1.6373798e-01f*xHinf[22]+5.5441165e-01f*xHinf[25]-2.9875091e-01f*xHinf[29]+8.1613138e-03f*e[1]-2.4229202e-03f*e[4];
    xHinfNext[26] = +6.0951700e-03f*xHinf[0]+2.8298417e-04f*xHinf[3]+2.4476110e-03f*xHinf[7]+1.0999196e-05f*xHinf[8]+5.6037720e-04f*xHinf[10]-5.1351724e-04f*xHinf[12]-3.0718246e-01f*xHinf[16]-2.9076877e-01f*xHinf[19]-1.6348046e-01f*xHinf[23]+5.5479914e-01f*xHinf[26]+2.9854470e-01f*xHinf[28]-8.3142845e-03f*e[0]+2.3987535e-03f*e[3];
    xHinfNext[27] = +1.0810926e-02f*xHinf[8]+1.3955079e-03f*xHinf[11]-9.8436687e-04f*xHinf[15]-4.8325872e-01f*xHinf[24]+3.3692473e-01f*xHinf[27]+1.5318104e-05f*xHinf[28]+7.9535529e-02f*xHinf[31];
    xHinfNext[28] = +5.0335620e-03f*xHinf[0]-1.1547208e-03f*xHinf[3]-1.2740927e-03f*xHinf[7]+1.8565503e-05f*xHinf[8]-1.5640522e-04f*xHinf[10]-2.6615820e-04f*xHinf[12]+1.1673127e-01f*xHinf[16]+1.1852766e-01f*xHinf[19]+6.0823571e-02f*xHinf[23]+1.7301822e-01f*xHinf[26]+8.7296385e-01f*xHinf[28]-8.6297048e-03f*e[0]+4.1629584e-03f*e[3];
    xHinfNext[29] = +4.9851206e-03f*xHinf[1]-1.1996373e-03f*xHinf[4]+1.2312960e-03f*xHinf[6]+1.5605122e-04f*xHinf[9]-2.6050938e-04f*xHinf[13]+1.1665732e-01f*xHinf[17]+1.1862319e-01f*xHinf[20]-6.0981181e-02f*xHinf[22]-1.7329152e-01f*xHinf[25]+8.7284321e-01f*xHinf[29]-8.5323593e-03f*e[1]+4.7253706e-03f*e[4];
    xHinfNext[30] = +2.6615079e-02f*xHinf[2]+2.5853161e-03f*xHinf[5]-2.5314339e-03f*xHinf[14]+4.2842463e-02f*xHinf[18]+1.2930973e-01f*xHinf[21]+8.2966560e-01f*xHinf[30]-4.7413591e-02f*e[2]-5.1483355e-04f*e[5];
    xHinfNext[31] = +9.5359925e-03f*xHinf[8]+1.9965605e-03f*xHinf[11]-1.1680261e-03f*xHinf[15]+2.4706485e-02f*xHinf[24]+5.1157266e-02f*xHinf[27]+9.8218918e-01f*xHinf[31];
    xHinfNext[32] = +1.2959941e-01f*xHinf[0]+1.0834963e-03f*xHinf[3]+1.4364489e-03f*xHinf[7]+1.5025149e-04f*xHinf[10]-5.8426806e-03f*xHinf[12]+1.0378535e-02f*xHinf[16]+6.2627178e-03f*xHinf[19]+2.6490623e-03f*xHinf[23]+9.5595177e-03f*xHinf[26]-6.6665345e-04f*xHinf[28]+6.5846276e-01f*xHinf[32]-2.5761651e-04f*xHinf[35]-3.9109218e-04f*xHinf[39]-1.1205930e-04f*xHinf[42]+3.8655631e-03f*xHinf[44]+1.0970730e-01f*xHinf[48]-1.1146150e-04f*xHinf[51]+3.1381070e-03f*xHinf[55]+1.4444228e-05f*xHinf[56]-1.8239555e-04f*xHinf[58]+1.5931800e-02f*xHinf[60]+6.6005141e-02f*e[0]-1.5548420e-03f*e[3]-3.0640602e-01f*e[12]+9.4497195e-03f*e[15]+1.3057886e-03f*e[19]-3.2087585e-03f*e[22];
    xHinfNext[33] = +1.2991351e-01f*xHinf[1]+1.0618720e-03f*xHinf[4]-1.4664872e-03f*xHinf[6]-1.5549638e-04f*xHinf[9]-5.7992474e-03f*xHinf[13]+1.0468896e-02f*xHinf[17]+6.3077752e-03f*xHinf[20]-2.6978378e-03f*xHinf[22]-9.8769078e-03f*xHinf[25]-6.4415636e-04f*xHinf[29]+6.5799874e-01f*xHinf[33]-1.9395993e-04f*xHinf[36]+3.9199620e-04f*xHinf[38]+1.1402478e-04f*xHinf[41]+3.8712448e-03f*xHinf[45]+1.0960891e-01f*xHinf[49]-2.2165057e-04f*xHinf[52]-3.4928259e-03f*xHinf[54]+2.8384931e-04f*xHinf[57]+1.6102115e-02f*xHinf[61]+6.6013545e-02f*e[1]+1.9459695e-02f*e[4]-3.0650166e-01f*e[13]+9.5227603e-03f*e[16]+4.7465208e-05f*e[18]+3.0701440e-03f*e[21];
    xHinfNext[34] = +1.3430877e-01f*xHinf[2]+8.3907129e-04f*xHinf[5]-9.5121041e-03f*xHinf[14]+1.0036044e-02f*xHinf[18]+6.1875409e-03f*xHinf[21]-1.9911056e-02f*xHinf[30]+6.4521366e-01f*xHinf[34]-7.0144648e-05f*xHinf[37]+2.9883115e-03f*xHinf[46]+1.2472993e-01f*xHinf[50]-7.3397183e-05f*xHinf[53]+9.8724815e-04f*xHinf[62]+7.1512654e-02f*e[2]+2.3665704e-02f*e[5]-3.0319625e-01f*e[14]+7.8120804e-03f*e[17];
    xHinfNext[35] = +3.2113686e-03f*xHinf[0]+1.4889760e-02f*xHinf[3]+1.4806307e-04f*xHinf[7]-2.4919576e-04f*xHinf[10]-1.1093287e-03f*xHinf[12]-6.6333952e-05f*xHinf[16]-1.5822929e-04f*xHinf[19]-9.5847819e-05f*xHinf[23]-2.8480036e-04f*xHinf[26]+1.2219523e-04f*xHinf[28]+5.5146433e-04f*xHinf[32]+3.6046004e-05f*xHinf[35]+5.3134201e-05f*xHinf[39]-1.2454641e-04f*xHinf[42]+4.6894290e-03f*xHinf[44]-1.9005560e-03f*xHinf[48]+2.8212226e-05f*xHinf[51]-1.0199095e-05f*xHinf[60]+1.8699979e-03f*e[0]+2.0718174e+00f*e[3]-1.1675318e-03f*e[12]+3.6275547e-04f*e[15]+7.8031002e-04f*e[19]+1.2932262e-04f*e[22];
    xHinfNext[36] = +3.4583439e-03f*xHinf[1]+1.4824091e-02f*xHinf[4]-8.6213615e-05f*xHinf[6]+2.7804420e-04f*xHinf[9]-1.1620430e-03f*xHinf[13]-1.0974782e-04f*xHinf[20]+6.8857451e-05f*xHinf[22]+1.9837951e-04f*xHinf[25]+8.3877923e-05f*xHinf[29]+4.4352803e-04f*xHinf[33]+3.5890615e-05f*xHinf[36]-5.3119980e-05f*xHinf[38]+1.3161136e-04f*xHinf[41]+4.8745247e-03f*xHinf[45]-1.4563807e-03f*xHinf[49]+2.0658903e-05f*xHinf[52]+1.0340739e-05f*xHinf[54]-5.3620650e-05f*xHinf[61]+2.2270600e-03f*e[1]+2.0719199e+00f*e[4]-9.1569783e-04f*e[13]+2.3131860e-04f*e[16]-5.4487208e-04f*e[18]-9.2217808e-05f*e[21];
    xHinfNext[37] = -5.7274777e-01f*xHinf[2]+2.3660066e-02f*xHinf[5]+1.4698431e-01f*xHinf[14]-2.1387268e-02f*xHinf[18]+1.0751785e-02f*xHinf[21]+1.3928282e-02f*xHinf[30]+1.8336480e-04f*xHinf[34]+1.0530008e-05f*xHinf[37]-1.2202253e-04f*xHinf[46]-3.6043883e-04f*xHinf[50]+2.0880720e-05f*xHinf[53]+2.1071747e-04f*xHinf[62]-3.3791673e-01f*e[2]+1.5670550e+00f*e[5]-3.2371990e-04f*e[14]-9.2349721e-05f*e[17];
    xHinfNext[38] = -7.4899807e-03f*xHinf[1]+2.6381058e-03f*xHinf[4]+1.4239162e-02f*xHinf[6]-7.2223041e-04f*xHinf[9]+2.6450502e-03f*xHinf[13]+7.0452814e-05f*xHinf[17]+3.2200079e-04f*xHinf[20]-1.9300956e-04f*xHinf[22]-5.5428239e-04f*xHinf[25]-2.1742842e-04f*xHinf[29]-9.2091371e-04f*xHinf[33]-5.2845815e-05f*xHinf[36]+1.0448271e-04f*xHinf[38]-2.7944686e-04f*xHinf[41]-9.4421050e-03f*xHinf[45]+3.0161950e-03f*xHinf[49]+1.4944516e-04f*xHinf[54]-6.1858859e-04f*xHinf[61]-6.5735877e-03f*e[1]-2.3145987e-02f*e[4]+1.8305802e-03f*e[13]-9.5770101e-04f*e[16]+1.9055593e-03f*e[18]+3.3734387e-04f*e[21];
    xHinfNext[39] = +7.5119571e-03f*xHinf[0]-2.4505774e-03f*xHinf[3]+1.4221083e-02f*xHinf[7]-7.2517275e-04f*xHinf[10]-2.6717375e-03f*xHinf[12]-7.0038019e-05f*xHinf[16]-3.2785896e-04f*xHinf[19]-1.9696569e-04f*xHinf[23]-5.8280746e-04f*xHinf[26]+2.0254808e-04f*xHinf[28]+9.2430838e-04f*xHinf[32]+5.2811494e-05f*xHinf[35]+1.0445990e-04f*xHinf[39]-2.8039704e-04f*xHinf[42]+9.4486410e-03f*xHinf[44]-2.9928703e-03f*xHinf[48]+1.5840889e-05f*xHinf[51]+1.3225427e-04f*xHinf[55]+6.0189754e-04f*xHinf[60]+6.6455160e-03f*e[0]+2.2083383e-02f*e[3]-1.8182573e-03f*e[12]+9.3119865e-04f*e[15]+1.9039336e-03f*e[19]+3.2551406e-04f*e[22];
    xHinfNext[40] = +1.2908231e-01f*xHinf[8]+7.7166583e-04f*xHinf[11]-2.6236291e-03f*xHinf[15]+1.3910799e-02f*xHinf[24]+1.4098468e-02f*xHinf[27]-7.2884734e-04f*xHinf[31]+6.7089927e-01f*xHinf[40]+8.6920874e-05f*xHinf[43]+4.0610209e-03f*xHinf[47]+1.0559650e-05f*xHinf[55]+1.0616002e-01f*xHinf[56]+4.6065031e-04f*xHinf[59]-3.0885967e-05f*xHinf[60]+1.1089551e-02f*xHinf[63]-2.9982306e-05f*e[19]-3.0417839e-01f*e[20]-5.2534044e-03f*e[23];
    xHinfNext[41] = +1.9438779e+00f*xHinf[1]+4.7225989e-03f*xHinf[4]-2.8627351e-02f*xHinf[6]+1.2760564e-02f*xHinf[9]-3.6362648e-01f*xHinf[13]+4.7220293e-02f*xHinf[17]-5.3591924e-03f*xHinf[20]+5.1901266e-03f*xHinf[22]+9.6488791e-03f*xHinf[25]-1.2437784e-02f*xHinf[29]-3.3339158e-05f*xHinf[33]+1.3532254e-04f*xHinf[36]-3.7749604e-04f*xHinf[38]+4.3404583e-02f*xHinf[41]-5.6623894e-04f*xHinf[45]+2.5443401e-04f*xHinf[49]-2.8013810e-05f*xHinf[61]+1.0443102e+00f*e[1]+3.3212371e+00f*e[4]+2.8244662e-04f*e[13]-1.0131310e-04f*e[16]+1.0948927e-04f*e[18]+2.4450197e-05f*e[21];
    xHinfNext[42] = -1.9493060e+00f*xHinf[0]-4.1907802e-03f*xHinf[3]-2.8520806e-02f*xHinf[7]+1.2748030e-02f*xHinf[10]+3.6608505e-01f*xHinf[12]-4.7556009e-02f*xHinf[16]+4.1009784e-03f*xHinf[19]+5.2134227e-03f*xHinf[23]+3.4548702e-05f*xHinf[24]+9.9938763e-03f*xHinf[26]+1.2312317e-02f*xHinf[28]+3.5064309e-05f*xHinf[32]-1.2808839e-04f*xHinf[35]-3.7854924e-04f*xHinf[39]+4.3404367e-02f*xHinf[42]+5.6821731e-04f*xHinf[44]-2.5131146e-04f*xHinf[48]+2.7773349e-05f*xHinf[60]-1.0495818e+00f*e[0]-3.1403110e+00f*e[3]-2.7890847e-04f*e[12]+9.8402234e-05f*e[15]+1.1298402e-04f*e[19]+2.3545897e-05f*e[22];
    xHinfNext[43] = -1.8991517e+00f*xHinf[8]+1.4706531e-02f*xHinf[11]-1.5119459e-05f*xHinf[12]+5.7705879e-01f*xHinf[15]-3.4288692e-05f*xHinf[16]+1.0621888e-05f*xHinf[23]-6.3092992e-02f*xHinf[24]+1.2044020e-05f*xHinf[26]+4.2078542e-03f*xHinf[27]+1.8428960e-05f*xHinf[28]+4.1025121e-02f*xHinf[31]+2.3658585e-04f*xHinf[40]+4.3429304e-02f*xHinf[43]+2.5089565e-04f*xHinf[47]+9.2838702e-05f*xHinf[56]+1.6570597e-05f*xHinf[59]+2.4651084e-04f*xHinf[63]-2.7723750e-04f*e[20]+1.0292972e-05f*e[23];
    xHinfNext[44] = -1.2360349e-03f*xHinf[0]-6.1788771e-05f*xHinf[3]-1.4469540e-04f*xHinf[7]-1.2776687e-05f*xHinf[10]+4.7395435e-05f*xHinf[12]-9.9425117e-05f*xHinf[16]-6.1203042e-05f*xHinf[19]-2.3394543e-05f*xHinf[23]-9.4247749e-05f*xHinf[26]-2.2976956e-05f*xHinf[28]+3.8503218e-03f*xHinf[32]+4.7000395e-03f*xHinf[35]+9.4664739e-03f*xHinf[39]+5.6985370e-04f*xHinf[42]+9.9982655e-01f*xHinf[44]-1.1840481e-03f*xHinf[48]-4.3191383e-05f*xHinf[55]-2.1329398e-04f*xHinf[60]-3.2046229e-02f*e[0]-9.3335230e-03f*e[3]+3.4923605e-03f*e[12]-8.4670930e-05f*e[15]+6.0935112e-05f*e[19]+5.3839511e-05f*e[22];
    xHinfNext[45] = -1.2379256e-03f*xHinf[1]-6.2144652e-05f*xHinf[4]+1.4480540e-04f*xHinf[6]+1.2544598e-05f*xHinf[9]+4.6764824e-05f*xHinf[13]-9.8034026e-05f*xHinf[17]-5.9921898e-05f*xHinf[20]+2.2624534e-05f*xHinf[22]+9.5259289e-05f*xHinf[25]-2.8729162e-05f*xHinf[29]+3.8572757e-03f*xHinf[33]+4.8833159e-03f*xHinf[36]-9.4598942e-03f*xHinf[38]-5.6787475e-04f*xHinf[41]+9.9982476e-01f*xHinf[45]-1.1818982e-03f*xHinf[49]+4.8980022e-05f*xHinf[54]-2.1994024e-04f*xHinf[61]-3.2047160e-02f*e[1]-9.9212220e-03f*e[4]+3.4945568e-03f*e[13]-8.0253332e-05f*e[16]-9.4553747e-05f*e[18]-5.6056680e-05f*e[21];
    xHinfNext[46] = -1.0955839e-03f*xHinf[2]-1.8312978e-05f*xHinf[5]+1.7948760e-04f*xHinf[14]-1.2523764e-04f*xHinf[18]-1.7701028e-04f*xHinf[21]+7.6218785e-05f*xHinf[30]+3.0004673e-03f*xHinf[34]-1.1891423e-04f*xHinf[37]+9.9979568e-01f*xHinf[46]-9.1467507e-04f*xHinf[50]-2.7755724e-04f*xHinf[62]-1.2577431e-01f*e[2]+2.8405961e-04f*e[5]+2.6044082e-03f*e[14]+7.6497163e-05f*e[17];
    xHinfNext[47] = -1.4906045e-03f*xHinf[8]+4.5975891e-04f*xHinf[15]-1.3254884e-04f*xHinf[24]-1.5125521e-04f*xHinf[27]-1.6160602e-05f*xHinf[31]+4.0644193e-03f*xHinf[40]+2.5448846e-04f*xHinf[43]+9.9922025e-01f*xHinf[47]-1.1664649e-03f*xHinf[56]-1.8580866e-05f*xHinf[59]-3.4870874e-04f*xHinf[63]+3.7928345e-03f*e[20]+2.5314916e-04f*e[23];
    xHinfNext[48] = +3.0677792e-02f*xHinf[0]-1.4433397e-04f*xHinf[3]-4.3990629e-04f*xHinf[7]+4.2666237e-05f*xHinf[10]-8.8358141e-04f*xHinf[12]+7.3227815e-02f*xHinf[16]+6.7335971e-02f*xHinf[19]+3.6137965e-02f*xHinf[23]+1.0784008e-01f*xHinf[26]-3.9679542e-02f*xHinf[28]+1.1230925e-01f*xHinf[32]-2.0954250e-03f*xHinf[35]-3.3091949e-03f*xHinf[39]-2.7454036e-04f*xHinf[42]-1.2275501e-03f*xHinf[44]+8.3042151e-01f*xHinf[48]-1.0232163e-03f*xHinf[51]+1.0637665e-02f*xHinf[55]-7.9552032e-04f*xHinf[58]+4.3457758e-02f*xHinf[60]+1.9418100e-02f*e[0]-6.1326742e-02f*e[3]+3.0008605e-01f*e[12]-7.5071506e-02f*e[15]-2.2322653e-01f*e[19]-4.7708429e-02f*e[22];
    xHinfNext[49] = +3.0758688e-02f*xHinf[1]-2.2927849e-04f*xHinf[4]+4.2825617e-04f*xHinf[6]-4.5334866e-05f*xHinf[9]-8.6739124e-04f*xHinf[13]+7.2946958e-02f*xHinf[17]+6.7024022e-02f*xHinf[20]-3.6034305e-02f*xHinf[22]-1.0749854e-01f*xHinf[25]-3.9701544e-02f*xHinf[29]+1.1234785e-01f*xHinf[33]-1.6183412e-03f*xHinf[36]+3.3227960e-03f*xHinf[38]+2.7656474e-04f*xHinf[41]-1.2308216e-03f*xHinf[45]+8.3077604e-01f*xHinf[49]-1.0493668e-03f*xHinf[52]-1.1324435e-02f*xHinf[54]+7.5753551e-04f*xHinf[57]+4.3635562e-02f*xHinf[61]+1.9367507e-02f*e[1]-6.1156418e-02f*e[4]+3.0011758e-01f*e[13]-7.4419945e-02f*e[16]+2.2330013e-01f*e[18]+4.7299575e-02f*e[21];
    xHinfNext[50] = +3.5420440e-02f*xHinf[2]-1.1096743e-04f*xHinf[5]-2.2802900e-03f*xHinf[14]+3.0040346e-02f*xHinf[18]+4.1109782e-02f*xHinf[21]-3.9696969e-02f*xHinf[30]+1.2373769e-01f*xHinf[34]-4.6681566e-04f*xHinf[37]-1.0287878e-03f*xHinf[46]+8.3906960e-01f*xHinf[50]-5.3114543e-04f*xHinf[53]+1.7068932e-02f*xHinf[62]+2.5051445e-02f*e[2]-4.5030918e-03f*e[5]+3.2018924e-01f*e[14]-1.2782547e-02f*e[17];
    xHinfNext[51] = +1.3297785e-03f*xHinf[0]+3.7145790e-05f*xHinf[3]-4.0326133e-05f*xHinf[7]-1.7582597e-05f*xHinf[10]-5.8013735e-05f*xHinf[12]+7.8317644e-03f*xHinf[16]+4.3548346e-03f*xHinf[19]+4.3807821e-03f*xHinf[23]+4.3858481e-03f*xHinf[26]-3.2854531e-02f*xHinf[28]+2.4645175e-03f*xHinf[32]-5.7874229e-05f*xHinf[35]-1.5101716e-04f*xHinf[39]-1.1087712e-05f*xHinf[42]-2.4720452e-05f*xHinf[44]+2.6434969e-02f*xHinf[48]-1.3992073e-02f*xHinf[51]-1.1728798e-02f*xHinf[55]-6.6197528e-05f*xHinf[58]-5.5532318e-02f*xHinf[60]+1.7452115e-03f*e[0]+2.6793482e+00f*e[3]+9.8406533e-03f*e[12]+2.6793289e+00f*e[15]-2.1431264e-02f*e[19]-1.2274348e-02f*e[22];
    xHinfNext[52] = +1.2264106e-03f*xHinf[1]+2.9091647e-05f*xHinf[4]+4.0634495e-05f*xHinf[6]+1.7234423e-05f*xHinf[9]-5.4910004e-05f*xHinf[13]+7.9441546e-03f*xHinf[17]+4.4629415e-03f*xHinf[20]-4.4846814e-03f*xHinf[22]-4.5341281e-03f*xHinf[25]-3.2811161e-02f*xHinf[29]+2.6053167e-03f*xHinf[33]-3.8998336e-05f*xHinf[36]+1.5289331e-04f*xHinf[38]+1.0884598e-05f*xHinf[41]-2.5732032e-05f*xHinf[45]+2.6333243e-02f*xHinf[49]-1.3827804e-02f*xHinf[52]+1.2938870e-02f*xHinf[54]-2.7237569e-05f*xHinf[57]-5.6686547e-02f*xHinf[61]+1.6816668e-03f*e[1]+2.6787961e+00f*e[4]+9.7870948e-03f*e[13]+2.6787226e+00f*e[16]+1.9262619e-02f*e[18]+1.2781323e-02f*e[21];
    xHinfNext[53] = -2.0967018e-02f*xHinf[2]+1.2592782e-03f*xHinf[5]+2.6466271e-03f*xHinf[14]+1.3786235e-01f*xHinf[18]+4.2125642e-01f*xHinf[21]+2.9573578e-01f*xHinf[30]-5.7721514e-02f*xHinf[34]+4.9374689e-04f*xHinf[37]+4.2020186e-04f*xHinf[46]-4.2168245e-01f*xHinf[50]-1.6533973e-02f*xHinf[53]+8.7738556e-01f*xHinf[62]-3.3503909e-02f*e[2]+2.2206838e+00f*e[5]-1.9271445e-01f*e[14]+2.2250118e+00f*e[17];
    xHinfNext[54] = -5.0092814e-03f*xHinf[1]-8.8440218e-05f*xHinf[4]+5.8512825e-05f*xHinf[6]+2.5680094e-04f*xHinf[13]+5.6984015e-03f*xHinf[17]+2.0332726e-02f*xHinf[20]-1.0675810e-03f*xHinf[22]-3.6805291e-02f*xHinf[25]+8.6857863e-02f*xHinf[29]-1.0568995e-02f*xHinf[33]+2.0019253e-04f*xHinf[36]-3.6222534e-04f*xHinf[38]-3.6890538e-05f*xHinf[41]+1.0690296e-04f*xHinf[45]-1.0126068e-01f*xHinf[49]+7.0640992e-04f*xHinf[52]+3.8445094e-03f*xHinf[54]+1.5546167e-03f*xHinf[57]-7.3214658e-02f*xHinf[61]-4.7573014e-03f*e[1]-1.8615641e-01f*e[4]-3.6858246e-02f*e[13]-1.8523693e-01f*e[16]+2.7651038e+00f*e[18]+1.1458423e-02f*e[21];
    xHinfNext[55] = +5.1724222e-03f*xHinf[0]+9.0286267e-05f*xHinf[3]+5.2384217e-05f*xHinf[7]-2.5937348e-04f*xHinf[12]-4.2200061e-03f*xHinf[16]-1.8625092e-02f*xHinf[19]-4.9696717e-04f*xHinf[23]+1.4996274e-05f*xHinf[24]-3.4182597e-02f*xHinf[26]+2.3244625e-05f*xHinf[27]-8.7386951e-02f*xHinf[28]+1.0055110e-02f*xHinf[32]-2.5263976e-04f*xHinf[35]-3.6225448e-04f*xHinf[39]+1.2805122e-05f*xHinf[40]-3.6527319e-05f*xHinf[42]-1.0347740e-04f*xHinf[44]+9.9842854e-02f*xHinf[48]-6.1992853e-04f*xHinf[51]+8.7736634e-04f*xHinf[55]+1.2954990e-04f*xHinf[56]+1.2915893e-03f*xHinf[58]+6.4001918e-02f*xHinf[60]+1.6967402e-05f*xHinf[63]+4.8907720e-03f*e[0]+1.8319413e-01f*e[3]+3.6459360e-02f*e[12]+1.8246894e-01f*e[15]+2.7579882e+00f*e[19]+3.7550864e-05f*e[20]+9.5122419e-03f*e[22];
    xHinfNext[56] = +2.4874721e-02f*xHinf[8]-1.9952877e-04f*xHinf[11]+3.9737197e-04f*xHinf[15]+1.2564728e-01f*xHinf[24]-1.1430926e-05f*xHinf[26]+1.7047019e-01f*xHinf[27]-1.5350504e-02f*xHinf[31]+1.3761222e-05f*xHinf[32]+1.1492785e-01f*xHinf[40]-1.3898193e-03f*xHinf[47]+1.4606501e-04f*xHinf[55]+8.2263172e-01f*xHinf[56]+3.8769050e-03f*xHinf[59]+3.6280886e-05f*xHinf[60]+7.7784494e-02f*xHinf[63]+1.2690834e-05f*e[12]-3.5496880e-04f*e[19]+3.0124030e-01f*e[20]+1.5665668e-05f*e[22]-5.9456974e-02f*e[23];
    xHinfNext[57] = +7.3834673e-02f*xHinf[1]+6.0102745e-04f*xHinf[4]+2.6128232e-03f*xHinf[6]+5.4326112e-04f*xHinf[9]-3.5094861e-03f*xHinf[13]+4.1101849e-01f*xHinf[17]+1.7794152e-01f*xHinf[20]-2.4053425e-01f*xHinf[22]-1.8290935e-01f*xHinf[25]-1.8169734e+00f*xHinf[29]+1.5917915e-01f*xHinf[33]-2.9146143e-03f*xHinf[36]+8.0606323e-03f*xHinf[38]+5.8379490e-04f*xHinf[41]-1.5865725e-03f*xHinf[45]+1.5454918e+00f*xHinf[49]+3.0203998e-02f*xHinf[52]+6.0253030e-01f*xHinf[54]+7.5027286e-03f*xHinf[57]-2.3566952e+00f*xHinf[61]+8.5533746e-02f*e[1]+2.7324283e+00f*e[4]+5.7165223e-01f*e[13]+2.7207325e+00f*e[16]-8.6242380e+00f*e[18]+5.6357193e-01f*e[21];
    xHinfNext[58] = -7.5259730e-02f*xHinf[0]-1.0031125e-03f*xHinf[3]+2.5788986e-03f*xHinf[7]-2.4837362e-05f*xHinf[8]+5.6022959e-04f*xHinf[10]+3.5572194e-03f*xHinf[12]-4.0921405e-01f*xHinf[16]-1.7278472e-01f*xHinf[19]-2.3609400e-01f*xHinf[23]-3.5925310e-05f*xHinf[24]-1.7597450e-01f*xHinf[26]-6.2648134e-05f*xHinf[27]+1.8174765e+00f*xHinf[28]-4.6716068e-05f*xHinf[31]-1.5709351e-01f*xHinf[32]+3.9410950e-03f*xHinf[35]+8.0053108e-03f*xHinf[39]-5.0127765e-05f*xHinf[40]+5.8639498e-04f*xHinf[42]+1.5966472e-03f*xHinf[44]-1.5506666e+00f*xHinf[48]-2.6666487e-02f*xHinf[51]+5.6130677e-01f*xHinf[55]+1.1727537e-04f*xHinf[56]+8.2418937e-03f*xHinf[58]+2.3393638e+00f*xHinf[60]-1.2398214e-04f*xHinf[63]-8.6913005e-02f*e[0]-2.7483649e+00f*e[3]-5.7326376e-01f*e[12]-2.7392430e+00f*e[15]-8.5509415e+00f*e[19]-3.1229961e-04f*e[20]+5.5025178e-01f*e[22]+7.0694477e-05f*e[23];
    xHinfNext[59] = +2.2785520e-05f*xHinf[0]-1.0726289e-01f*xHinf[8]+2.7779306e-03f*xHinf[11]-3.2586148e-03f*xHinf[15]-2.4928298e-05f*xHinf[19]-1.1780583e-05f*xHinf[23]-1.0365136e+00f*xHinf[24]-2.2994023e-05f*xHinf[26]-1.0837144e+00f*xHinf[27]+5.7435489e-05f*xHinf[28]+4.1199881e-01f*xHinf[31]-6.2639861e-05f*xHinf[32]-2.1330972e-01f*xHinf[40]+8.6781610e-04f*xHinf[43]+3.2342346e-03f*xHinf[47]+1.5945450e-05f*xHinf[48]+1.5745180e-05f*xHinf[51]-2.2514610e-04f*xHinf[55]-1.5836561e+00f*xHinf[56]+1.8118323e-01f*xHinf[59]+3.4679595e-04f*xHinf[60]+2.5944798e+00f*xHinf[63]+2.5567280e-05f*e[0]-1.4569900e-05f*e[12]+6.5350212e-04f*e[19]-8.3943552e-01f*e[20]+1.9097361e-05f*e[22]+3.2188475e-01f*e[23];
    xHinfNext[60] = +5.6959153e-03f*xHinf[0]+1.3655781e-04f*xHinf[3]+6.5426936e-04f*xHinf[7]-1.2573631e-05f*xHinf[8]+1.2005854e-04f*xHinf[10]-3.4284306e-04f*xHinf[12]-8.8346407e-02f*xHinf[16]-1.0411118e-01f*xHinf[19]-4.3955442e-02f*xHinf[23]-1.9473753e-05f*xHinf[24]-1.5803595e-01f*xHinf[26]-2.7182834e-05f*xHinf[27]+4.5317854e-03f*xHinf[28]+1.2752524e-02f*xHinf[32]-2.3144325e-04f*xHinf[35]+2.0609052e-04f*xHinf[39]-3.3423206e-05f*xHinf[40]-2.4284196e-05f*xHinf[42]-1.3938760e-04f*xHinf[44]+9.6416332e-02f*xHinf[48]-1.4499638e-02f*xHinf[51]+1.7740558e-01f*xHinf[55]+3.7983835e-05f*xHinf[56]+3.3528465e-03f*xHinf[58]+7.9866040e-01f*xHinf[60]-3.2670989e-05f*xHinf[63]+1.6730616e-03f*e[0]+2.1778628e-01f*e[3]+3.8165625e-02f*e[12]+2.1627086e-01f*e[15]+4.5421492e-02f*e[19]-1.0192019e-04f*e[20]+1.4955086e-01f*e[22]+2.5043710e-05f*e[23];
    xHinfNext[61] = +5.5196173e-03f*xHinf[1]+1.9825489e-04f*xHinf[4]-6.4481091e-04f*xHinf[6]-1.1765377e-04f*xHinf[9]-3.3572715e-04f*xHinf[13]-8.8724904e-02f*xHinf[17]-1.0456975e-01f*xHinf[20]+4.4083729e-02f*xHinf[22]+1.5889558e-01f*xHinf[25]+4.5874352e-03f*xHinf[29]+1.2827419e-02f*xHinf[33]-2.1608525e-04f*xHinf[36]-2.0778616e-04f*xHinf[38]+2.5763293e-05f*xHinf[41]-1.3778528e-04f*xHinf[45]+9.7066365e-02f*xHinf[49]-1.5122022e-02f*xHinf[52]-1.8764931e-01f*xHinf[54]-3.4547695e-03f*xHinf[57]+7.8989404e-01f*xHinf[61]+1.6218442e-03f*e[1]+2.2029190e-01f*e[4]+3.7859648e-02f*e[13]+2.1871926e-01f*e[16]-2.2242846e-02f*e[18]-1.5119602e-01f*e[21];
    xHinfNext[62] = -6.2188756e-04f*xHinf[2]+1.1649433e-04f*xHinf[5]-7.8395853e-05f*xHinf[14]-4.5194276e-02f*xHinf[18]-1.3436440e-01f*xHinf[21]+8.5725553e-02f*xHinf[30]-2.0057579e-04f*xHinf[34]+2.3121080e-04f*xHinf[37]+4.2067248e-02f*xHinf[50]+5.1550654e-04f*xHinf[53]+9.0947825e-01f*xHinf[62]-7.8376215e-03f*e[2]+4.1736942e-02f*e[5]-9.9598067e-03f*e[14]+4.2442013e-02f*e[17];
    xHinfNext[63] = +4.1761659e-03f*xHinf[8]+1.3682018e-04f*xHinf[11]-2.2660279e-04f*xHinf[15]+1.0204947e-05f*xHinf[19]-1.3184547e-01f*xHinf[24]+1.2975838e-05f*xHinf[26]-2.1509226e-01f*xHinf[27]+5.1290425e-03f*xHinf[31]+9.1371418e-04f*xHinf[40]+2.3658888e-04f*xHinf[43]-7.1717681e-05f*xHinf[47]+1.1418541e-05f*xHinf[55]+1.7353816e-01f*xHinf[56]+5.1196836e-02f*xHinf[59]-3.2764026e-05f*xHinf[60]+7.4727964e-01f*xHinf[63]-2.1139105e-05f*e[3]-2.0732523e-05f*e[15]-5.4827869e-05f*e[19]+8.5667195e-03f*e[20]-1.3236429e-05f*e[22]+4.2521540e-02f*e[23];

#elif CFNUM==3

#endif

    
    memcpy(xHinf, xHinfNext, sizeof(xHinf));
    
    control->thrust = u[0] + 0.31f;
    control->roll = u[1];
    control->pitch = u[2];
    control->yaw = u[3];
    control->enabled = 1;
  }

}
